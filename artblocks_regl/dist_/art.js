let e,t,o,a,s,i;console.log(tokenData.hash);let r=Math,l=r.min,p=r.max,n=r.floor,f=r.abs,m=r.cos,c=r.sin,y=document.createElement("div");y.classList.add("debug"),y.style.width="100%",y.style.height="100px",document.body.appendChild(y);let d=location.href.split("#")[1],rotArray=e=>e[0].map(((t,o)=>e.slice().reverse().map((e=>e[o]))));const u=0,h=3,b=4,x=5,g=6,A=7,z=30;let v,D,k,M,w,$,E,T,B,S,N,C,P,H,I,F,U,L,X,_,R,G,K,j,O,W=.95532,Z=40,q=10,init=()=>{e=new Uint32Array([0,1,t=a=2,3].map((e=>parseInt(tokenData.hash.substr(8*e+2,8),16)))),o=()=>(a=e[3],e[3]=e[2],e[2]=e[1],e[1]=t=e[0],a^=a<<11,e[0]^=a^a>>>8^t>>>19,e[0]/2**32),s=(e,t)=>e[e.length*o()**(t||1)|0],i=e=>e.map((e=>[e,o()])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0])),F=[],U=1e-6,C={Symmetry:o()**4*2|0,Studs:o()**8*2|0,Palette:0,ColorScheme:5*(1-o()**.3)|0,Layout:0,Height:0,Eyes:0,Aerials:0,BlocksNumber:0,BackgroundType:s([2,1],.5),BackgroundLight:(3*o()|0)-1},v=3.1415*(C.Symmetry-.5)/2-3.1415;let r=[{gs:8+2*o()|0,blocksNumber:30,fitnessFunctionNumber:5,maxTry:8,extra:0},{gs:8+2*o()|0,blocksNumber:30,fitnessFunctionNumber:3,maxTry:8,extra:o()**4*8},{gs:4,blocksNumber:3+4*o()|0,fitnessFunctionNumber:0,maxTry:1,extra:1},{gs:6+4*o()|0,blocksNumber:10+20*o()|0,fitnessFunctionNumber:2,maxTry:6,extra:2*o()},{gs:6+(0|o()),blocksNumber:10+10*o()|0,fitnessFunctionNumber:0,maxTry:4,extra:o()**2*3}];C.Layout=o()**.3*r.length|0,({gs:E,blocksNumber:T,fitnessFunctionNumber:B,maxTry:S,extra:N}=r[C.Layout]),D=2+2*o()|0,I=[],C.Palette=o()**.5*8|0,$="dddddd888888555555222222aaaaaaf26b21fbb04099ca3c208b3afcec529b5de5f15bb500bbf900f5d4fee440f1faeea8dadc457b9d1d3557e6394650514ff25f5c247ba070c1b3ffe066541388d90368f1e9da2e294effd4001f20414b3f72119da419647effc857540d6eee4266f3fcf01f271bffd23fe4572e29335ca8c686669bbcf3a712".slice(30*C.Palette,30*(C.Palette+1)),console.log("u_palette",$);let l=3*o()+1|0;$=$.substring(6*l)+$.substring(0,6*l),console.log("u_palette",$),$=$.match(/(.{2})/g).map((e=>Number("0x"+e)/255))};function placeBlocks(){let e=i([{size:[2,1,2],maskTop:[[0,1],[0,1]],type:h},{size:[2,1,2],maskBottom:[[0,1],[0,1]],type:b},{size:[2,1,4],type:u},{size:[2,1,3],type:u},{size:[1,1,6],type:u},{size:[1,2,3],maskBottom:[[1,0,1]],type:x},{size:[1,1,3],type:u},{size:[2,1,2],type:u},{size:[1,1,1],type:u},{size:[1,2,1],type:u}].filter((e=>e.size[2]<E))).slice(0,D),t=i([{size:[1,4,1],maskTop:[[0]],type:6},{size:[1,.5,1],maskTop:[[0]],type:7}]);P=[...Array(E)].map((()=>Array(E).fill(0))),H=[...Array(E)].map((()=>Array(E).fill(0)));for(let a=0;a<T;a++){let i,l,m,c=0,y=-9e9,d=0,u=s(e);a>=T-N&&4!=C.ColorScheme&&(u=s(t,.7),B=6,S=6,d=1);for(let e=0;e<S;e++){m=JSON.parse(JSON.stringify(u)),m.color=4*o()+1|0,m.color2=4*o()+1|0,2==C.ColorScheme&&(m.color=m.color2=1),m.texture=4*o()|0,1==C.ColorScheme&&(m.texture=0),m.symX=1,m.rot=4*o()|0,7==m.type&&(m.rot=0);let makeMask=()=>Array(9).fill(Array(9).fill(1));m.maskBottom=m.maskBottom||makeMask(),m.maskTop=m.maskTop||makeMask(),m.span=[...m.size];for(let e=0;e<m.rot;e++)m.span.reverse(),m.maskBottom=rotArray(m.maskBottom),m.maskTop=rotArray(m.maskTop),m.symX=!m.symX;if(m.span[0]>E/2){S<30&&S++;continue}m.pos=E%2==0?[m.span[0]/2+(o()*(E/2+1-m.span[0])|0),0,-E/2+m.span[2]/2+(o()*(E+1-m.span[2])|0)]:[m.span[0]/2+(o()*((E-1)/2+1-m.span[0])|0)+.5,0,-E/2+m.span[2]/2+(o()*(E+1-m.span[2])|0)],m.span[0]%2==E%2&&o()<1/(E-m.span[0])&&(m.span[0]%2||m.symX)&&(m.pos[0]=0);let t=0,a=0,s=[...Array(m.span[0])].map(((e,t)=>m.pos[0]+t-(m.span[0]-1)/2)),d=[...Array(m.span[2])].map(((e,t)=>m.pos[2]+t-(m.span[2]-1)/2));for(let e of s)for(let o of d)e>=0?a++:t++;let h=0,b=0,x=0,g=0;for(let e of d)for(let t of s){let o=g%m.span[0],a=n(g/m.span[0]);g++,b=p(b,P[t+E/2-.5][e+E/2-.5]),x=p(x,H[t+E/2-.5][e+E/2-.5]),1==m.maskBottom[o][a]&&(h=p(h,P[t+E/2-.5][e+E/2-.5]))}h<x||h>b?S<30&&S++:(i=[0,-r.hypot(m.pos[0],m.pos[2]),-h,-r.hypot(m.pos[0],h-10,m.pos[2]),-f(r.hypot(m.pos[0],h-10,m.pos[2])-E),-f(r.hypot(m.pos[0],2*h,m.pos[2])-E),2*h+m.pos[2]][B],(i>y||0==e)&&(y=i,c=h,l=m))}if(l&&(l.pos[1]=c+l.size[1]/2,l.pos[1])){if(d&&l.pos[1]-l.span[1]/2==0)continue;let e=Array(l.span[0]).fill().map(((e,t)=>l.pos[0]+t-(l.span[0]-1)/2)),t=Array(l.span[2]).fill().map(((e,t)=>l.pos[2]+t-(l.span[2]-1)/2)),o=0;for(let a of t)for(let t of e){let e=o%l.span[0],s=n(o/l.span[0]);o++,P[t+E/2-.5][a+E/2-.5]=c+l.size[1],0==l.maskTop[e][s]&&(P[t+E/2-.5][a+E/2-.5]=-99),H[t+E/2-.5][a+E/2-.5]=c+l.size[1]}I.push(l);for(let e=0;e++<8;){let t=[0,0,0].map(((t,o)=>(e>>o&1)-.5));F.push([t[0]*(l.span[0]+2*l.pos[0]),t[1]*l.span[1]+l.pos[1],t[2]*l.span[2]+l.pos[2]])}}}}let J,findViewBox=()=>{L={top:-1e9,bottom:1e9,left:1e9,right:-1e9};let rot=(e,t,o)=>[e*m(o)-t*c(o),e*c(o)+t*m(o)];F.forEach((e=>{let[t,o,a]=e;[t,a]=rot(t,a,-v),[o,a]=rot(o,a,-W),L.left=l(t,L.left),L.right=p(t,L.right),L.bottom=l(o,L.bottom),L.top=p(o,L.top)})),L.width=L.right-L.left,L.height=L.top-L.bottom,L.scale=p(L.width/1.8,L.height/1.8,1),L.offset={x:L.left+L.width/2,y:L.bottom+L.height/2}};init(),placeBlocks(),findViewBox(),console.log($),u_colors=I.map((e=>[e.color,e.color2,e.texture])).flat();let V="";V+=I.map(((e,t)=>`positions[${t}]=vec3(${e.pos[0]},${e.pos[1]},${e.pos[2]});`)).join(""),V+=I.map(((e,t)=>`sizes[${t}]=vec3(${e.size[0]},${e.size[1]},${e.size[2]});`)).join(""),V+=I.map(((e,t)=>`colors[${t}]=ivec3(${e.color},${e.color2},${e.texture});`)).join(""),V+=I.map(((e,t)=>`roty[${t}]=vec2(${e.rot},${e.type});`)).join("");let Q=Math.min(window.innerWidth,window.innerHeight)*window.devicePixelRatio,Y=document.createElement("canvas");Y.style.width=Q/window.devicePixelRatio+"px",Y.style.height=Q/window.devicePixelRatio+"px",Q=l(Q,2048);const ee=Y.getContext("webgl",{preserveDrawingBuffer:!0});document.body.appendChild(Y),Y.style.background=`rgb(${$.slice(0,3).map((e=>255*e))})`,4!=C.ColorScheme&&3!=C.ColorScheme||(Y.style.background="#333"),Y.width=Q,Y.height=Q;let te=16;var oe=createREGL(ee);const ae=oe({frag:`precision highp float;\n#define A 60\n#define B 3.1415\n#define C smoothstep\n#define D vec3\n#define E vec2\nfloat F(float G){return fract(54321.987*sin(987.12345*mod(G,12.34567)));}mat2 H(float I){return mat2(cos(I),-sin(I),sin(I),cos(I));}\n#define J 4e2\n#define K .001\nfloat L(float M){return sqrt(abs(M)*abs(M)+5e-5);}float N(float I,float O){return(I+O+L(I-O))*.5;}mediump vec3 positions[A];mediump vec3 sizes[A];mediump vec2 roty[A];mediump ivec3 colors[A];uniform mediump D palette[20];uniform mediump float aa;uniform mediump float res;uniform mediump vec4 vb;ivec3 P;float Q;mediump float R=1e2;float S(D M,D T,float U){M.y-=clamp(M.y,-T.x,T.x);float V=length(M.xz)-T.z;V-=clamp(V,-T.y,T.y);float S=length(E(V,M.y))-U;return S;}int W;float X(vec3 M,float Y,float Z,float a){M.y-=clamp(M.y,K,Y);mediump vec2 b=vec2(length(M.xz),M.y);b.x-=clamp(b.x,a,Z);return length(b)-K;}float c(D M){P=ivec3(0,0,-1);M.x=abs(M.x);mediump float d=M.y+1.;for(int e=0;e<A;e++){W=0;if(e>=${I.length})break;mediump D f=M;f-=positions[e];f.xz*=H(roty[e].x*B/2.);mediump float U=.01;mediump float g=.008;mediump float h;mediump D T=sizes[e]-2.*(U+g);h=length(f-clamp(f,-(T)/2.,(T)/2.))-U*1.4;if(roty[e].y==5.){mediump float S=length(f.zy)-.5;mediump float i=max(abs(f.z)-.5,abs(f.y+sizes[e].y/2.)-1.);mediump float j=min(S,i);h=max(h,-j);}if(roty[e].y==6.){mediump float k=X(f+vec3(0,1.6-U*2.,0),3.6-U*2.,.15,0.);mediump float l=X(f+vec3(0,2.-U*2.,0),.4-U*2.,.45,0.);h=min(k,l);}if(roty[e].y!=6.){mediump D m=f;mediump E n=sizes[e].xz;m.xz+=(n-1.)/2.;m.xz=m.xz-clamp(floor(m.xz+.5),E(0.),n-1.);m.y-=sizes[e].y/2.+.02;mediump float o=X(m,.24,.28,mix(K,.18,${C.Studs}.));h=min(o,h);}if(f.z<0.15&&(roty[e].y==3.||roty[e].y==4.)){h=N(h,(-f.z*.8-(roty[e].y==3.?-1.:1.)*f.y-.5)/1.4142);}if(roty[e].y==7.){mediump float p=X(f+vec3(0,.25-U*2.,0),.4-U*2.,.45,0.);h=p;if(p<K){W=1;}}if(h<d){d=h;P=colors[e];}if(d<K)break;}return d;}D q(D M){mediump E r=E(.01,0.);return normalize(D(c(M+r.xyy)-c(M-r.xyy),c(M+r.yxy)-c(M-r.yxy),c(M+r.yyx)-c(M-r.yyx)));}void main(){${V}mediump D s=D(0);mediump vec2 t,u=(gl_FragCoord.xy*2.-res)/res;for(mediump float v=0.;v<8.;v++){if(v>=aa)break;Q=0.;mediump float Z=0.,r=1e9,w,x;float y=floor(v/2.);float z=mod(v,2.);vec2 AA=vec2(z/2.,y/4.)-.5;if(mod(y,2.)==0.)AA.x+=.25;vec2 t=u;t+=AA*2./res;t=t*.5+.5;t*=vb.zw;t+=vb.xy;t=t*2.-1.;D M,AB=D(t*float(${L.scale})+E(${L.offset.x},${L.offset.y}),-R),AC=D(0,0,.9+.1*F(length(t)));bool AD=false;for(float e=0.;e<J;e++){x=e;M=Z*AC+AB;M.z-=R;M.yz*=H(${W});M.xz*=H(${v});Z+=r=c(M);if(w<r&&r<.01){AD=true;break;}w=r;if(r<K||r>R*2.)break;}D AE;if(!AD){D AF,AG;for(int x=0;x<20;x++){if(P[0]==x)AF=palette[x];if(P[1]==x)AG=palette[x];}D AH=AF;if(P.z==1)if(sin(M.y*B*3.)>0.)AH=AG;if(P.z==2)if(sin((M.x+fract(positions[0].x-sizes[0].x/2.))*B*2.*1.5)>0.)AH=AG;if(${C.ColorScheme}==3)AH=sin((length(M)/max(float(${E}),float(${C.Height}))*2.-D(0,.3,.6))*6.28)*.5+.5;if(W==1){AH=D(0);D AI=M+fract(${E}./2.);AI=fract(AI)-.5;AH+=step(.3,length(AI.xz));AH+=step(-.1,-length(AI.xz+.1));}if(P.z==-1){AE=palette[0];if(length(AE)>.4){AE*=smoothstep(5.,0.,length(t+E(${C.BackgroundLight},-1)));}if(${C.ColorScheme}==3){AE=D(.2);}if(sin(length(pow(abs(t),E(${C.BackgroundType})))*32.)>0.)AE*=.95;}else{AE=D(1,0,1);AE=(min(1.5,14./x)*.2+.8)*(dot(q(M),normalize(D(0,1,1)))*.2+.8)*AH;AE+=pow(abs(dot(q(M),normalize(D(0.,3.,1.)))),40.);}}if(${C.ColorScheme}==4)AE=(D(7./x));s+=AE;}gl_FragColor=vec4(s/aa,1);}`,vert:"attribute vec2 position;void main(){gl_Position=vec4(position,0,1);}",attributes:{position:[[-1,-1],[-1,1],[1,-1],[-1,1],[1,-1],[1,1]]},uniforms:{res:oe.prop("res"),palette:$,aa:oe.prop("aa"),vb:oe.prop("vb")},scissor:{enable:!0,box:{x:oe.prop("x"),y:oe.prop("y"),width:oe.prop("ts_"),height:oe.prop("ts_")}},count:6});let se=1+(Q/j|0),ie=0;function*spiral(){let[e,t,o,a]=[0,0,1,1];for(;;){for(;2*e*o<a;)yield[e,t],e+=o;for(;2*t*o<a;)yield[e,t],t+=o;o=-o,a++}}let re=spiral();a=+new Date;let le=1,pe=8,ne=1;te=16,O=2*(Q/te/2|0)+3,j=Q/O|0;let fe=0,me=oe.frame((function(){for(let e=0;e++<ne;){let[e,t]=re.next().value;ae({res:Q,x:Q/2-j/2+j*e|0,y:Q/2-j/2-j*t|0,ts_:j,aa:pe,vb:[0,0,1,1]}),ie++}console.log("new Date() - t",new Date-a),new Date-a>160&&(ne=p(1,ne-2)),new Date-a<40&&(ne+=2),1==ne?fe++:fe=p(0,fe--),console.log("slowDevice",fe),fe>8&&(pe=1),d&&(pe=Number(d)),a=+new Date,ie>(O+2)**2&&me.cancel()}));'tx shvembldr piter stranger'